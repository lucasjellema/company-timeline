/* Map Popup Image Preview */
.map-popup-footer {
    display: flex;
    justify-content: flex-end;
    margin-top: 5px;
}

.map-popup-image-wrapper {
    position: relative;
    display: inline-flex;
    align-items: center;
    justify-content: center;
}

.map-popup-icon {
    cursor: pointer;
    color: var(--primary);
    opacity: 0.8;
    transition: opacity 0.2s;
    background: rgba(255, 255, 255, 0.1);
    padding: 4px;
    border-radius: 4px;
}

.map-popup-icon:hover {
    opacity: 1;
    background: rgba(255, 255, 255, 0.2);
}

.map-popup-image-preview {
    display: none;
    position: fixed;
    /* Fixed relative to viewport to avoid clipping in popup */
    /* We'll use JS/CSS combo or just hope absolute works within leaflet containers which often have overflow hidden? 
       Actually leaflet popups usually expand. But hovering might cause flicker if size changes.
       Let's try absolute positioning relative to the wrapper first. */
    position: absolute;
    bottom: 25px;
    /* Above the icon */
    right: 0;
    max-width: 250px;
    max-height: 200px;
    background: var(--bg-card);
    border: 1px solid var(--border);
    border-radius: 4px;
    padding: 2px;
    box-shadow: 0 4px 12px rgba(0, 0, 0, 0.3);
    z-index: 10000;
    /* High z-index */
}

.map-popup-image-wrapper:hover .map-popup-image-preview {
    display: block;
}

/* Ensure Leaflet popup allows overflow if needed? Leaflet popups usually wrap content. 
   If absolute positioned 'outside' the div, it might be clipped. 
   Let's ensure the image is inside the popup flow OR carefully positioned. 
   Actually, if I make it 'display: block' in flow, the popup will grow, which is fine. */
.map-popup-image-wrapper:hover .map-popup-image-preview {
    /* display: block normally works, but let's see if we want it floating.
        Floating is better to not push content around. 
        Leaflet .leaflet-popup-content-wrapper has overflow: visible usually. 
        .leaflet-popup-content has specific styling.
     */
}